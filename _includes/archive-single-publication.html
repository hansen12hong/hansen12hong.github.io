{% include base_path %}

{% if post.header.teaser %}
  {% capture teaser %}{{ post.header.teaser }}{% endcapture %}
{% else %}
  {% assign teaser = site.teaser %}
{% endif %}

{% if post.id %}
  {% assign title = post.title | markdownify | remove: "<p>" | remove: "</p>" %}
{% else %}
  {% assign title = post.title %}
{% endif %}

<div class="publication-card">
  <!-- Status Badge -->
  <div class="pub-badges">
    {% if post.category == 'manuscripts' %}
      <span class="pub-badge pub-badge--published">Published</span>
    {% elsif post.venue contains 'Revise' or post.venue contains 'R&R' or post.venue contains 'Resubmit' %}
      <span class="pub-badge pub-badge--rr">Under Review</span>
    {% else %}
      <span class="pub-badge pub-badge--wp">Working Paper</span>
    {% endif %}
  </div>

  <!-- Title -->
  <h3 class="pub-title">
    <a href="{{ base_path }}{{ post.url }}" rel="permalink">{{ title }}</a>
  </h3>

  <!-- Authors (if specified) -->
  {% if post.authors %}
  <p class="pub-authors">{{ post.authors }}</p>
  {% endif %}

  <!-- Venue and Year -->
  <p class="pub-venue">
    {% if post.category == 'manuscripts' %}
      <span class="venue-name">{{ post.venue }}</span>, {{ post.date | date: "%Y" }}
    {% elsif post.venue contains 'Revise' or post.venue contains 'R&R' or post.venue contains 'Resubmit' %}
      <span class="venue-status">{{ post.venue }}</span>
    {% else %}
      <span class="venue-name">{{ post.venue }}</span>
    {% endif %}
  </p>

  <!-- Abstract/Excerpt -->
  {% if post.excerpt %}
  <div class="pub-abstract">
    {{ post.excerpt | markdownify | strip_html | truncatewords: 50 }}
  </div>
  {% endif %}

  <!-- Links -->
  <div class="pub-links">
    {% if post.paperurl %}
      {% if post.paperurl contains 'doi.org' %}
        <a href="{{ post.paperurl }}" class="pub-link pub-link--doi" target="_blank">
          <i class="fas fa-external-link-alt"></i> Publisher
        </a>
      {% else %}
        <a href="{{ post.paperurl }}" class="pub-link pub-link--paper" target="_blank">
          <i class="fas fa-file-pdf"></i> PDF
        </a>
      {% endif %}
    {% endif %}
    
    {% if post.slidesurl %}
      <a href="{{ post.slidesurl }}" class="pub-link pub-link--slides" target="_blank">
        <i class="fas fa-desktop"></i> Slides
      </a>
    {% endif %}
    
    {% if post.codeurl %}
      <a href="{{ post.codeurl }}" class="pub-link pub-link--code" target="_blank">
        <i class="fab fa-github"></i> Code
      </a>
    {% endif %}
  </div>
</div>
