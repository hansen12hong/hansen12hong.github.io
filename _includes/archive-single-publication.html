{% include base_path %}

{% if post.header.teaser %}
  {% capture teaser %}{{ post.header.teaser }}{% endcapture %}
{% else %}
  {% assign teaser = site.teaser %}
{% endif %}

{% if post.id %}
  {% assign title = post.title | markdownify | remove: "<p>" | remove: "</p>" %}
{% else %}
  {% assign title = post.title %}
{% endif %}

<div class="publication-card">
  <!-- Status Badge -->
  <div class="pub-badges">
    {% if post.status == 'Accepted' %}
      <span class="pub-badge pub-badge--accepted">Accepted</span>
    {% elsif post.category == 'manuscripts' %}
      <span class="pub-badge pub-badge--published">Published</span>
    {% elsif post.category == 'pre_doctoral' %}
      <span class="pub-badge pub-badge--predoc">Pre-doctoral</span>
    {% elsif post.venue contains 'Conditionally Accepted' %}
      <span class="pub-badge pub-badge--ca">Conditionally Accepted</span>
    {% elsif post.venue contains 'Reject' and post.venue contains 'Resubmit' %}
      <span class="pub-badge pub-badge--reject-resubmit">Reject & Resubmit</span>
    {% elsif post.venue contains 'Revise' or post.venue contains 'R&R' %}
      <span class="pub-badge pub-badge--rr">Revise & Resubmit</span>
    {% elsif post.category == 'work_in_progress' %}
      <span class="pub-badge pub-badge--wip">Work in Progress</span>
    {% else %}
      <span class="pub-badge pub-badge--wp">Working Paper</span>
    {% endif %}
    {% if post.award %}
      <span class="pub-badge pub-badge--award">{{ post.award }}</span>
    {% endif %}
  </div>

  <!-- Title - Link directly to paper URL -->
  <h3 class="pub-title">
    {% if post.paperurl %}
      <a href="{{ post.paperurl }}" target="_blank">{{ title }}</a>
    {% else %}
      {{ title }}
    {% endif %}
  </h3>

  <!-- Authors (if specified) -->
  {% if post.authors %}
  <p class="pub-authors">{{ post.authors }}</p>
  {% endif %}

  <!-- Venue and Year -->
  <p class="pub-venue">
    {% if post.status == 'Accepted' %}
      <span class="venue-name">{{ post.venue }}</span>, <span class="venue-status">Accepted</span>
    {% elsif post.category == 'manuscripts' %}
      <span class="venue-name">{{ post.venue }}</span>, {{ post.date | date: "%Y" }}
    {% elsif post.category == 'pre_doctoral' %}
      <span class="venue-name">{{ post.venue }}</span>{% if post.venue != 'Working Paper' %}, {{ post.date | date: "%Y" }}{% endif %}
    {% elsif post.venue contains 'Conditionally Accepted' or post.venue contains 'Revise' or post.venue contains 'R&R' or post.venue contains 'Resubmit' %}
      <span class="venue-status">{{ post.venue }}</span>
    {% else %}
      <span class="venue-name">{{ post.venue }}</span>
    {% endif %}
  </p>

  <!-- Abstract/Excerpt -->
  {% if post.excerpt %}
  <div class="pub-abstract">
    {{ post.excerpt | markdownify | strip_html | truncatewords: 50 }}
  </div>
  {% endif %}
</div>

